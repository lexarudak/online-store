!function(){"use strict";var t={91:function(t){t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},428:function(t,e,a){t.exports=a.p+"assets/eucalypt.png"},226:function(t,e,a){t.exports=a.p+"assets/empty-cart-icon.svg"},302:function(t,e,a){t.exports=a.p+"assets/rs_school.svg"}},e={};function a(n){var i=e[n];if(void 0!==i)return i.exports;var r=e[n]={exports:{}};return t[n](r,r.exports,a),r.exports}a.m=t,a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,{a:e}),e},a.d=function(t,e){for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/",a.b=document.baseURI||self.location.href,function(){var t=a(91),e=a.n(t),n=new URL(a(428),a.b),i=new URL(a(302),a.b),r=new URL(a(226),a.b),s=(e()(n),e()(i),e()(r),JSON.parse('{"products":[{"id":1,"title":"Echeveria SC-092","description":"Succulent plants are drought-resistant plants in which the leaves, stem, or roots have become more than usually fleshy by the development of water-storing tissue.","height":18,"price":15,"discountPercentage":20,"rating":4.5,"stock":28,"type":"Succulent","thumbnail":"plants/1/1.jpg","images":["plants/1/1.jpg","plants/1/2.jpg","plants/1/3.jpg"]},{"id":2,"title":"Echeveria SC-018","description":"Flowers on short stalks (cymes) arise from compact rosettes of succulent fleshy, often brightly coloured leaves.","height":17,"price":18,"discountPercentage":0,"rating":4.3,"stock":34,"type":"Succulent","thumbnail":"plants/2/1.jpg","images":["plants/2/1.jpg","plants/2/2.jpg","plants/2/3.jpg"]},{"id":3,"title":"Echeveria SC-035","description":"Echeveria is a large genus of flowering plant in the family Crassulaceae, native to semi-desert areas of Central America, Mexico and northwestern South America.","height":10,"price":10,"discountPercentage":10,"rating":4.6,"stock":36,"type":"Succulent","thumbnail":"plants/3/1.jpg","images":["plants/3/1.jpg","plants/3/2.jpg","plants/3/3.jpg"]},{"id":4,"title":"Echeveria SC-019","description":"Plants are polycarpic, meaning that they may flower and set seed many times over the course of their lifetimes.","height":15,"price":22,"discountPercentage":0,"rating":4.8,"stock":13,"type":"Succulent","thumbnail":"plants/4/1.jpg","images":["plants/4/1.jpg","plants/4/2.jpg","plants/4/3.jpg"]},{"id":5,"title":"Echeveria SC-018","description":"Echeveria is named for Atanasio Echeverría y Godoy, a botanical illustrator who contributed to Flora Mexicana.","height":14,"price":20,"discountPercentage":10,"rating":4.3,"stock":32,"type":"Succulent","thumbnail":"plants/5/1.jpg","images":["plants/5/1.jpg","plants/5/2.jpg"]},{"id":6,"title":"Aeonium AN-023","description":"A feature which distinguishes this genus from many of its relatives is the manner in which the flowers bear free petals, and are divided into 6 or 12 sections.","height":15,"price":10,"discountPercentage":50,"rating":3.7,"stock":23,"type":"Succulent","thumbnail":"plants/6/1.jpg","images":["plants/6/1.jpg","plants/6/2.jpg"]},{"id":7,"title":"Sansevieria SV-01","description":"The plant has distinct sword-like leaves that grow upright, having an uncanny resemblance to artificial foliage.","height":55,"price":30,"discountPercentage":10,"rating":4.2,"stock":0,"type":"Sansevieria","thumbnail":"plants/7/1.jpg","images":["plants/7/1.jpg","plants/7/2.jpg"]},{"id":8,"title":"Sansevieria SV-02","description":"Plants are easy to care for and maintain; hence are greatly found in closed spaces like homes and offices.","height":50,"price":25,"discountPercentage":20,"rating":4.1,"stock":38,"type":"Sansevieria","thumbnail":"plants/8/1.jpg","images":["plants/8/1.jpg","plants/8/2.jpg"]},{"id":9,"title":"Sansevieria SV-09","description":"It’s a hardy, resilient plant that can withstand low-light conditions, fewer water requirements, and dry environments, both indoors and outdoors.","height":55,"price":30,"discountPercentage":0,"rating":4.5,"stock":36,"type":"Sansevieria","thumbnail":"plants/9/1.jpg","images":["plants/9/1.jpg","plants/9/2.jpg"]},{"id":10,"title":"Strelitzia SL-03","description":"The leaves are large, similar to a banana leaf in appearance, but with a longer petiole, and arranged strictly in two ranks to form a fan-like crown of evergreen foliage.","height":95,"price":50,"discountPercentage":20,"rating":4.8,"stock":28,"type":"Flowering plant","thumbnail":"plants/10/1.jpg","images":["plants/10/1.jpg","plants/10/2.jpg"]},{"id":11,"title":"Strelitzia SL-08","description":"It is a low-maintenance plant that is easy to grow in the garden; it is fairly tolerant of soil conditions and needs little water once established. If cared for well, they will flower several times in a year","height":75,"price":40,"discountPercentage":10,"rating":4.2,"stock":65,"type":"Flowering plant","thumbnail":"plants/11/1.jpg","images":["plants/11/1.jpg","plants/11/2.jpg"]},{"id":12,"title":"Spathiphyllum","description":"With the striking contrast of the dark green foliage and the creamy white flowers held high on stiff stems it holds it\'s own well and looks attractive in all types of homes and design schemes.","height":55,"price":38,"discountPercentage":0,"rating":4.6,"stock":52,"type":"Flowering plant","thumbnail":"plants/12/1.jpg","images":["plants/12/1.jpg","plants/12/2.jpg"]},{"id":13,"title":"Orchid OR-012","description":"Orchids are popular houseplants that typically can be started anytime for indoor growth, though repotting is best after flowering.","height":26,"price":20,"discountPercentage":20,"rating":4.8,"stock":40,"type":"Flowering plant","thumbnail":"plants/13/1.jpg","images":["plants/13/1.jpg","plants/13/2.jpg"]},{"id":14,"title":"Orchid OR-037","description":"Orchids have a mystique that seems to set them apart from most other flowers: They are elegant and almost unreal in their perfection. Even though orchids are one of the largest flowering plant families, every orchid species has a unique look.","height":27,"price":25,"discountPercentage":0,"rating":4.8,"stock":40,"type":"Flowering plant","thumbnail":"plants/14/1.jpg","images":["plants/14/1.jpg","plants/14/2.jpg"]},{"id":15,"title":"Fern FR-005","description":"It\'s such a universal plant that it perfectly fits any interior - regardless of its style. But it\'s a particularly good choice for Boho and urban jungle styles.","height":45,"price":30,"discountPercentage":10,"rating":4.7,"stock":35,"type":"Fern","thumbnail":"plants/15/1.jpg","images":["plants/15/1.jpg","plants/15/2.jpg","plants/15/3.jpg"]},{"id":16,"title":"Fern FRA-013","description":"Fern is one of the most popular house plants. Although there are several hundreds of fern species of various needs, the most common ones are fairly easy to grow and they don\'t need any special treatment. ","height":180,"price":98,"discountPercentage":50,"rating":4.2,"stock":14,"type":"Fern","thumbnail":"plants/16/1.jpg","images":["plants/16/1.jpg","plants/16/2.jpg"]},{"id":17,"title":"Lavender LV-03","description":"Lavender is technically a flower, herb, and a shrub. It is a flowering semi-woody herbaceous shrub often used as an herb in the kitchen or traditional medicine cabinet.","height":36,"price":13,"discountPercentage":0,"rating":4.5,"stock":38,"type":"Lavender","thumbnail":"plants/17/1.jpg","images":["plants/17/1.jpg","plants/17/2.jpg"]},{"id":18,"title":"Lavender LV-07","description":"Lavenders are small evergreen shrubs with gray-green hoary linear leaves. The purple flowers are sparsely arranged on spikes at the tips of long bare stalks and produce small nutlet fruits.","height":30,"price":10,"discountPercentage":20,"rating":4.6,"stock":23,"type":"Lavender","thumbnail":"plants/18/1.jpg","images":["plants/18/1.jpg","plants/18/2.jpg"]},{"id":19,"title":"Cactus CCT-011","description":"Cactus plants are a popular decorating trend, but they have additional benefits beyond adding some low-maintenance greenery to your home.","height":25,"price":24,"discountPercentage":20,"rating":4.4,"stock":34,"type":"Cactus","thumbnail":"plants/19/1.jpg","images":["plants/19/1.jpg","plants/19/2.jpg"]},{"id":20,"title":"Cactus CCT-035","description":"One of the key features in the botanical description of a cactus plant is that it has clusters of spines, which are unique to cactus. Unlike the prickly parts of other plants, such as pine needles, cactus spines do not act as leaves or contain any cells or signs of life.","height":120,"price":70,"discountPercentage":10,"rating":4.1,"stock":31,"type":"Cactus","thumbnail":"plants/20/1.jpg","images":["plants/20/1.jpg","plants/20/2.jpg"]},{"id":21,"title":"Cactus CCT-017","description":"Cacti are unique among many plant species for their ability to adapt to extremely dry environments. They don\'t have leaves, so photosynthesis occurs in their trunks.","height":65,"price":40,"discountPercentage":20,"rating":4.4,"stock":33,"type":"Cactus","thumbnail":"plants/21/1.jpg","images":["plants/21/1.jpg","plants/21/2.jpg"]},{"id":22,"title":"Boxwood","description":"Boxwood is prized for their densely packed, light-green leaves and a rounded, compact growth habit.","height":105,"price":80,"discountPercentage":30,"rating":4.5,"stock":46,"type":"Tree","thumbnail":"plants/22/1.jpg","images":["plants/22/1.jpg","plants/22/2.jpg","plants/22/3.jpg"]},{"id":23,"title":"Ficus Lyrata","description":"Ficus is a popular indoor tree featuring very large, heavily veined, and glossy violin-shaped leaves that grow upright on a sleek trunk.","height":130,"price":90,"discountPercentage":20,"rating":4.4,"stock":13,"type":"Tree","thumbnail":"plants/23/1.jpg","images":["plants/23/1.jpg","plants/23/2.jpg"]},{"id":24,"title":"Clusia","description":"The foliage is this plant\'s feature characteristic - leaves are thick and leathery, shaped like fat teardrops or paddles.","height":125,"price":88,"discountPercentage":50,"rating":4.5,"stock":27,"type":"Tree","thumbnail":"plants/24/1.jpg","images":["plants/24/1.jpg","plants/24/2.jpg"]}],"total":24}'));const o={PLANTS10:10,SALE10:10,FORYOU10:10};function c(t){return t instanceof EventTarget}function l(t,e=document){const a=e.querySelector(t);if(null===a)throw new Error("Element not found!");return a}function p(t,e,a){const n=a.id.toString();a.stock>0?(n in e.basket?t.classList.add("button-purple"):t.classList.add("button"),n in e.basket?t.innerHTML="In your cart":t.innerHTML="Add to cart",t.addEventListener("click",(function(){n in e.basket?e.delete(n):e.add(n),n in e.basket?t.classList.replace("button","button-purple"):t.classList.replace("button-purple","button"),n in e.basket?t.innerHTML="In your cart":t.innerHTML="Add to cart",e.updateHeader()}))):(t.classList.add("button-unable"),t.innerHTML="Not available")}function d(t){const e=document.querySelector("#purchase");e instanceof HTMLTemplateElement&&new class{constructor(t,e){this.modalContainer=l(".purchase-modal");const a=t.content.cloneNode(!0);if(!c(a))throw new Error("Element is not HTMLElement!");this.modal=a,this.name=l("#purchaseName",this.modal),this.phone=l("#purchasePhone",this.modal),this.address=l("#purchaseAddress",this.modal),this.email=l("#purchaseEmail",this.modal),this.card=l("#payCardNumber",this.modal),this.cardDate=l("#payCardDate",this.modal),this.cardCVV=l("#payCardCvv",this.modal),this.payNowBtn=l("#payNowBtn",this.modal),this.form=l(".purchase-form",this.modal),this.formValid=!1,this.cart=e}isNameValid(){const t=l("#purchaseName"),e=l("#purchaseNameError");if(t instanceof HTMLInputElement){let a=0;const n=t.value.trim(),i=n.split(" ");if(i.length<2&&(a+=1),i.forEach((t=>{t.length<3&&(a+=1)})),0===a&&""!==n?e.classList.remove("purchase-form__error_active"):e.classList.add("purchase-form__error_active"),0===a)return!0}return!1}checkPhoneSymbol(t){const e=t.target;if(null===e)throw new Error("Element not found!");if(!(e instanceof HTMLInputElement))throw new Error("Element not input!");e.value="+"+e.value.replace(/\D+/g,"")}isPhoneValid(){const t=l("#purchasePhone"),e=l("#purchasePhoneError");if(t instanceof HTMLInputElement){let a=0;const n=t.value.replace(/\D+/g,"");if(n.length<9&&(a+=1),0===a?e.classList.remove("purchase-form__error_active"):e.classList.add("purchase-form__error_active"),t.value=`+${n}`,0===a)return!0}return!1}isAddressValid(){const t=l("#purchaseAddress"),e=l("#purchaseAddressError");if(t instanceof HTMLInputElement){let a=0;const n=t.value,i=n.split(" ");if(i.length<3&&(a+=1),i.forEach((t=>{t.length<5&&(a+=1)})),0===a&&""!==n?e.classList.remove("purchase-form__error_active"):e.classList.add("purchase-form__error_active"),0===a)return!0}return!1}isEmailValid(){const t=l("#purchaseEmail"),e=l("#purchaseEmailError");if(t instanceof HTMLInputElement){const a=/^[\w-.]+@[\w-]+\.[a-z]{2,4}$/i.test(t.value);if(a?e.classList.remove("purchase-form__error_active"):e.classList.add("purchase-form__error_active"),a)return!0}return!1}checkCardSymbol(t){const e=t.target;if(null===e)throw new Error("Element not found!");if(!(e instanceof HTMLInputElement))throw new Error("Element not input!");e.value=e.value.replace(/\D+/g,"").split(/(\d{4})/).filter((t=>""!==t)).join(" ").trim().substring(0,19)}checkCardLogo(t){const e=t.target,a=l(".purchase-form__card-icon");if(null===e)throw new Error("Element not found!");if(!(e instanceof HTMLInputElement))throw new Error("Element not input!");switch(e.value[0]){case"4":a.style.backgroundImage="url(./assets/svg/visa-icon.svg)";break;case"5":a.style.backgroundImage="url(./assets/svg/master-card-icon.svg)";break;case"3":a.style.backgroundImage="url(./assets/svg/american-express-icon.svg)";break;default:a.style.backgroundImage="url(./assets/svg/credit-card-payment-icon.svg)"}}isCardNumberValid(){const t=l("#payCardNumber"),e=l("#payCardNumberError");if(!(t instanceof HTMLInputElement))throw new Error("Element not input!");return 19===t.value.length?e.classList.remove("purchase-form__error_active"):e.classList.add("purchase-form__error_active"),19===t.value.length}checkCardDateSymbol(t){const e=t.target;if(null===e)throw new Error("Element not found!");if(!(e instanceof HTMLInputElement))throw new Error("Element not input!");e.value=e.value.replace(/\D+/g,"").split(/(\d{2})/).filter((t=>""!==t)).join(" / ").trim().substring(0,7)}isCardDateValid(){const t=l("#payCardDate"),e=l("#payCardDateError");if(!(t instanceof HTMLInputElement))throw new Error("Element not input!");const a=7===t.value.length&&Number(t.value.slice(0,2))>0&&Number(t.value.slice(0,2))<13;return a?e.classList.remove("purchase-form__error_active"):e.classList.add("purchase-form__error_active"),!!a}checkCardCVVSymbol(t){const e=t.target;if(null===e)throw new Error("Element not found!");if(!(e instanceof HTMLInputElement))throw new Error("Element not input!");e.value=e.value.replace(/\D+/g,"").substring(0,3)}isCardCVVValid(){const t=l("#payCardCvv"),e=l("#payCardCvvError");if(!(t instanceof HTMLInputElement))throw new Error("Element not input!");return 3===t.value.length?e.classList.remove("purchase-form__error_active"):e.classList.add("purchase-form__error_active"),3===t.value.length}isFormValid(){this.isNameValid()&&this.isPhoneValid()&&this.isAddressValid()&&this.isEmailValid()&&this.isCardNumberValid()&&this.isCardDateValid()&&this.isCardCVVValid()?(this.payNowBtn.classList.replace("button-unable","button"),this.formValid=!0,this.payNowBtn.innerText="Buy now!"):(this.payNowBtn.classList.replace("button","button-unable"),this.formValid=!1,this.payNowBtn.innerText="Fill in all the fields")}buyNow(){l(".purchase-modal__wrapper").classList.add("purchase-modal__wrapper_hide");const t=document.createElement("div");t.classList.add("purchase__message-container");const e=document.createElement("div");e.classList.add("purchase__message"),t.append(e),this.modalContainer.append(t);let a=0;for(;a<=3;){const t=a;setTimeout((()=>{0===Math.abs(t-3)?(this.cart.cleanCart(),L.goTo("/catalog"),this.modalContainer.classList.remove("purchase-modal__active"),document.body.classList.remove("body_hold"),this.modalContainer.innerHTML=""):e.innerHTML=`Thank you for your purchase. Return to catalog page after ${Math.abs(t-3)} sec.`}),1e3*a),a++}}draw(){document.body.classList.add("body_hold"),this.modalContainer.innerHTML="",this.modalContainer.addEventListener("click",(t=>{const e=t.target;if(!c(e))throw new Error("Element is not HTMLElement!");e.classList.contains("purchase-modal")&&(this.modalContainer.classList.remove("purchase-modal__active"),document.body.classList.remove("body_hold"),this.modalContainer.innerHTML="")})),this.phone.addEventListener("input",(t=>this.checkPhoneSymbol(t))),this.card.addEventListener("input",(t=>this.checkCardSymbol(t))),this.card.addEventListener("input",(t=>this.checkCardLogo(t))),this.cardDate.addEventListener("input",(t=>this.checkCardDateSymbol(t))),this.cardCVV.addEventListener("input",(t=>this.checkCardCVVSymbol(t))),this.name.addEventListener("blur",this.isNameValid),this.phone.addEventListener("blur",this.isPhoneValid),this.address.addEventListener("blur",this.isAddressValid),this.email.addEventListener("blur",this.isEmailValid),this.card.addEventListener("blur",this.isCardNumberValid),this.cardDate.addEventListener("blur",this.isCardDateValid),this.cardCVV.addEventListener("blur",this.isCardCVVValid),this.form.addEventListener("change",(()=>this.isFormValid())),this.payNowBtn.addEventListener("click",(()=>{this.formValid&&this.buyNow()})),this.modalContainer.append(this.modal),this.modalContainer.classList.add("purchase-modal__active")}}(e,t).draw()}var u,h=class{constructor(t,e){this.container=document.getElementById("page-container"),this.id=e,this.cart=t}fillPage(t,e){return console.log("Load page:",e),t}makePage(t){const e=document.getElementById(this.id);if(e instanceof HTMLTemplateElement&&this.container){const a=e.content.cloneNode(!0);return a instanceof DocumentFragment?this.fillPage(a,t):a}return null}draw(t){const e=this.makePage(t);e&&this.container&&(this.container.innerHTML="",document.documentElement.scrollTop,this.container.append(e))}},g=class extends h{constructor(t){super(t,"cart"),this.cart=t,this.pageInfo={itemsOnPage:3,currentPage:1}}getTotal(){let t=this.cart.getProductSum();return this.cart.activePromoCodes.length>0&&this.cart.activePromoCodes.forEach((e=>{t*=(100-o[e])/100})),`$${Math.floor(t).toString()}`}getProductDiscount(){return`- ${Math.floor(100*(1-this.cart.getProductSum()/this.cart.getProductOldSum())).toString()} %`}makePromoCard(t,e){const a=document.createElement("li");a.id=t;const n=document.createElement("span"),i=document.createElement("span");return a.classList.add("discounts__item","discounts__item-promo"),n.innerText=`Promo ${t}`,i.innerText=`- ${e} %`,a.append(n,i),a}setPromoCodes(t){t.innerHTML="",this.cart.activePromoCodes.length>0&&this.cart.activePromoCodes.forEach((e=>{if(e in o){const a=this.makePromoCard(e,o[e]);t.appendChild(a)}}))}updateBill(t){const e=t.querySelector("#bill-item");e&&(e.innerHTML=this.cart.getProductAmount().toString());const a=t.querySelector("#bill-old-sum");a&&(a.innerHTML=this.cart.getProductOldSum().toString());const n=t.querySelector("#bill-product-discount-value");n&&(n.innerHTML=this.getProductDiscount());const i=t.querySelector("#bill-promo-container");i instanceof HTMLElement&&this.setPromoCodes(i);const r=t.querySelector("#bill-total");r&&(r.innerHTML=this.getTotal()),this.setQuery()}setCartFromQuery(){const t=new URL(window.location.href).searchParams.get("cart");if(t){const e=JSON.parse(t);this.isCartValid(e)&&(this.cart.basket=e.basket,this.cart.activePromoCodes=e.activePromoCodes)}}setPaginationFromQuery(){const t=new URL(window.location.href).searchParams.get("pageInfo");t&&(this.pageInfo=JSON.parse(t))}setQuery(){const t=new URL(window.location.href);t.searchParams.set("cart",JSON.stringify(this.cart)),t.searchParams.set("pageInfo",JSON.stringify(this.pageInfo)),window.history.pushState("",t.toString(),t)}isCartValid(t){let e=0;!t.activePromoCodes&&(e+=1),!t.basket&&(e+=1);for(const a in t.basket){const n=s.products.filter((t=>t.id.toString()===a))[0];!n&&(e+=1),n.stock<t.basket[a]&&(e+=1)}return 0===e}fillPage(t){this.setCartFromQuery(),this.setPaginationFromQuery();const e=t.querySelector(".cart-page__container");if(0===this.cart.getProductAmount()){const t=document.getElementById("empty-cart");if(t instanceof HTMLTemplateElement){const a=t.content.cloneNode(!0);null==e||e.append(a)}}else{const t=document.getElementById("full-cart");if(t instanceof HTMLTemplateElement){const a=t.content.cloneNode(!0);if(a instanceof DocumentFragment){const t=this.fillFullPage(a);null==e||e.append(t)}}}return t}fillFullPage(t){const e=t.querySelector("#bill");if(e){this.updateBill(e);const a=t.querySelector(".full-cart-page__promo-input");a instanceof HTMLInputElement&&(a.addEventListener("input",(()=>this.cart.addPromo(a))),a.addEventListener("input",(()=>this.updateBill(e))),e.addEventListener("click",(t=>{const a=t.target;if(a instanceof HTMLElement){const t=a.closest(".discounts__item-promo");t&&(this.cart.deletePromo(t),this.updateBill(e))}})))}const a=t.querySelector(".full-cart-page__buy-button");a&&a.addEventListener("click",(()=>d(this.cart)));const n=t.querySelector(".full-cart-page__products");if(n instanceof HTMLElement&&e){l(".clean-card-btn",n).addEventListener("click",(()=>{this.cart.cleanCart(),L.goTo("/cart")}));const t=new class{constructor(t){this.container=t,this.cardsContainer=t.querySelector(".cart-list"),this.currentPageContainer=t.querySelector("#paginationCurrentPage"),this.maxPageContainer=t.querySelector("#pagination-max-pages"),this.itemsOnPageContainer=t.querySelector("#pagination-items")}changeCartList(t,e,a){const n=t.target;if(n instanceof HTMLElement){switch(n.id){case"paginationPageUp":this.currentPageUp(e,a);break;case"paginationPageDown":this.currentPageDown(e,a);break;case"pagination-items-plus":a=this.itemsOnPageUp(e,a);break;case"pagination-items-minus":a=this.itemsOnPageDown(e,a);break;default:n.classList.contains("product__right-arrow")&&(e=this.updateCart(e,a,n.closest(".cart-list__item"),"up")),n.classList.contains("product__left-arrow")&&(e=this.updateCart(e,a,n.closest(".cart-list__item"),"down")),this.getMaxPage(e,a)<a.currentPage&&0!==this.getMaxPage(e,a)&&(a.currentPage-=1,L.goTo("/cart"))}e.updateHeader(),this.updateCartList(e,a)}return{cart:e,pageInfo:a}}updateCartList(t,e){this.currentPageContainer instanceof HTMLInputElement&&(this.currentPageContainer.value=e.currentPage.toString()),this.itemsOnPageContainer instanceof HTMLInputElement&&(this.itemsOnPageContainer.value=e.itemsOnPage.toString()),this.maxPageContainer instanceof HTMLInputElement&&(this.maxPageContainer.value=this.getMaxPage(t,e).toString())}updateCart(t,e,a,n){if(a){const i=a.id;switch(n){case"up":t.add(i),this.updateCard(a,t,i);break;case"down":t.delete(i),t.basket[i]?this.updateCard(a,t,i):a.remove(),!this.isCurrentPageValid(t,e)&&this.currentPageDown(t,e),!this.getMaxPage(t,e)&&L.goTo("/cart")}}return t}updateCard(t,e,a){const n=s.products.filter((t=>t.id===Number(a)))[0],i=l(".product__price",t),r=l(".product__old-price",t),o=l(".product__amount-number",t);if(i.innerHTML="$"+(n.price*e.basket[a]).toString(),n.discountPercentage){const t=Math.ceil(n.price*e.basket[a]/((100-n.discountPercentage)/100));r.innerHTML="$"+t.toString()}o.value=e.basket[a].toString()}getMaxPage(t,e){const a=Object.keys(t.basket).length;return Math.ceil(a/e.itemsOnPage)}isCurrentPageValid(t,e){return!(this.getMaxPage(t,e)<e.currentPage)}currentPageUp(t,e){const a=this.getMaxPage(t,e);e.currentPage<a&&(e.currentPage+=1),this.fillCards(t,e)}currentPageDown(t,e){e.currentPage>1&&(e.currentPage-=1),this.fillCards(t,e)}itemsOnPageUp(t,e){return e.itemsOnPage<10&&(e.itemsOnPage+=1),!this.isCurrentPageValid(t,e)&&this.currentPageDown(t,e),this.fillCards(t,e),e}itemsOnPageDown(t,e){return e.itemsOnPage>1&&(e.itemsOnPage-=1),this.fillCards(t,e),e}fillCards(t,e){if(this.cardsContainer){this.cardsContainer.innerHTML="";const a=Object.keys(t.basket),n=(e.currentPage-1)*e.itemsOnPage;a.forEach(((a,i)=>{if(i>=n&&i<n+e.itemsOnPage){const e=new class{constructor(t,e,a){this.id=t,this.link=`/${t}`,this.plant=s.products.filter((e=>e.id===Number(t)))[0],this.number=e,this.count=a,this.emptyCard=this.createEmptyCard(),this.priceContainer=l(".product__price",this.emptyCard),this.oldPriceContainer=l(".product__old-price",this.emptyCard),this.countContainer=l(".product__amount-number",this.emptyCard)}createEmptyCard(){const t=document.getElementById("product-cart-card");if(t instanceof HTMLTemplateElement){const e=t.content.cloneNode(!0);if(!c(e))throw new Error("Element is not HTMLElement!");return e}}draw(t){const e=this.emptyCard;if(e){if(l(".cart-list__item",e).id=this.id,l(".product__photo",e).style.backgroundImage=`url('assets/img/${this.plant.thumbnail}')`,l(".cart-list__number",e).innerText=this.number.toString(),l(".product__rating",e).innerHTML=this.plant.rating.toString()+"<span>&#9734;</span>",l(".product__type",e).innerText=this.plant.type,l(".product__title",e).innerText=this.plant.title,l(".product__stock-value",e).innerHTML=this.plant.stock.toString(),l(".product",e).addEventListener("click",(t=>{const e=t.target;e instanceof HTMLElement&&!e.classList.contains("button-arrow")&&L.goTo(this.link)})),this.countContainer.value=this.count.toString(),this.priceContainer.innerHTML="$"+(this.plant.price*this.count).toString(),this.plant.discountPercentage>0){const t=document.createElement("div");t.classList.add("product__discount"),t.innerHTML=this.plant.discountPercentage.toString()+"<span> %</span>",l(".product__icons",e).prepend(t);const a=Math.ceil(this.plant.price*this.count/((100-this.plant.discountPercentage)/100));this.oldPriceContainer.innerHTML="$"+a.toString(),this.priceContainer.classList.add("product-page__new-price_sale")}t.append(e)}}}(a,i+1,t.basket[a]);this.cardsContainer&&e.draw(this.cardsContainer)}}))}}}(n);n.addEventListener("click",(a=>{const n=t.changeCartList(a,this.cart,this.pageInfo);this.cart=n.cart,this.pageInfo=n.pageInfo,this.updateBill(e),this.setQuery()})),t.updateCartList(this.cart,this.pageInfo),t.fillCards(this.cart,this.pageInfo),this.cart.updateHeader(),this.setQuery()}return t}};!function(t){t.category="type",t.height="height",t.sale="discountPercentage"}(u||(u={}));var m=class{constructor(t){this.parentSelector=t,this.priceInputMin=l(".input-min",t),this.priceInputMax=l(".input-max",t),this.rangeInputMin=l(".range-min",t),this.rangeInputMax=l(".range-max",t),this.range=l(".slider__progress",t)}changePriceInputMin(){const t=+this.priceInputMax.value;for(+this.priceInputMin.value>=t&&(this.priceInputMin.value=(t-1).toString()),+this.priceInputMin.value<1&&(this.priceInputMin.value="1");"0"===this.priceInputMin.value[0];)this.priceInputMin.value=this.priceInputMin.value.slice(1);+this.priceInputMin.value&&(this.rangeInputMin.value=this.priceInputMin.value,this.range.style.left=+this.priceInputMin.value/+this.rangeInputMin.max*100+"%")}changePriceInputMax(){const t=+this.priceInputMin.value;for(+this.priceInputMax.value>100&&(this.priceInputMax.value="100"),+this.priceInputMax.value<=t&&(this.priceInputMax.value=(t+1).toString());"0"===this.priceInputMax.value[0];)this.priceInputMax.value=this.priceInputMax.value.slice(1);this.rangeInputMax.value=this.priceInputMax.value,this.range.style.right=100-+this.priceInputMax.value/+this.rangeInputMax.max*100+"%"}changeRangeInputMin(){const t=+this.rangeInputMin.value,e=+this.rangeInputMax.value;e-t<1?this.rangeInputMin.value=(e-1).toString():(this.priceInputMin.value=t.toString(),this.range.style.left=t/+this.rangeInputMin.max*100+"%")}changeRangeInputMax(){const t=+this.rangeInputMin.value,e=+this.rangeInputMax.value;e-t<1?this.rangeInputMax.value=(t+1).toString():(this.priceInputMax.value=e.toString(),this.range.style.right=100-e/+this.rangeInputMax.max*100+"%")}},f=class{constructor(t){this.selectedArr=[],this.filterType=t}checkboxTypeFilter(t,e){if(!c(t))throw new Error;t instanceof HTMLInputElement&&(t.checked?this.selectedArr.push(t.value):t.checked||this.selectedArr.splice(this.selectedArr.indexOf(t.value),1));let a=e;if(this.selectedArr.length){if(this.filterType===u.sale)return a.filter((t=>t.discountPercentage));const t=[];for(const e of this.selectedArr)if(this.filterType===u.category){const n=a.filter((t=>t.type.toLowerCase()===e));t.push(n)}else this.filterType===u.height&&t.push(this.filterByHeight(e,a));a=t.flat()}return a}filterByHeight(t,e){return"short"===t?e.filter((t=>t.height<=30)):"medium"===t?e.filter((t=>t.height>30&&t.height<=100)):e.filter((t=>t.height>100))}},y=class extends h{constructor(t){super(t,"catalog"),this.productCard=new class{constructor(t){this.cart=t}draw(t){const e=t,a=document.createDocumentFragment(),n=l("#productCardTemp");e.forEach((t=>{const e=n.content.cloneNode(!0);if(!c(e))throw new Error("Element is not HTMLElement!");l(".product__photo",e).style.backgroundImage=`url('assets/img/${t.thumbnail}')`,l(".product__type",e).textContent=t.type,l(".product__title",e).textContent=t.title,l(".product__description",e).textContent=t.description,l(".product__price",e).textContent=t.price.toString(),l(".product__stock-num",e).textContent=t.stock.toString(),l(".product__rating-num",e).textContent=t.rating.toString(),t.discountPercentage?(l(".product__discount-num",e).textContent=t.discountPercentage.toString(),l(".product__price",e).style.color="#ab5abb"):l(".product__discount",e).style.display="none",l(".product__title",e).addEventListener("click",(function(){L.goTo(`/${t.id}`)}));const i=l("button",e);p(i,this.cart,t),l(".product",e).addEventListener("click",(e=>{e.target!==i&&L.goTo(`/${t.id}`)})),a.append(e)})),l(".products__container").innerHTML="",l(".products__container").appendChild(a)}}(t)}drawProductCard(t){const e=t.products?t.products:[];this.productCard.draw(e);const a=new class{constructor(t){this.priceRangeInputParent=l(".filter__price"),this.priceRangeInput=new m(this.priceRangeInputParent),this.stockRangeInputParent=l(".filter__stock"),this.stockRangeInput=new m(this.stockRangeInputParent),this.categoryFilter=new f(u.category),this.heightFilter=new f(u.height),this.saleFilter=new f(u.sale),this.filteredData=new class{constructor(t){this.sortData=t,this.inputData=t,this.checkCategoryData=t,this.checkHeightData=t,this.checkSaleData=t,this.priceData=t,this.stockData=t}getFinalData(){const t=Object.values(this);return this.getIntersection(...t)}getIntersection(...t){let e=t[0];for(let a=1;a<t.length;a++)e=e.filter((e=>t[a].indexOf(e)>-1));return e}}(t),this.productCount=l(".found-products__num")}rangeInputFilter(t,e){if(!c(t))throw new Error;if(t.closest(".filter__stock")){const t=this.stockRangeInput,[a,n]=this.addListenerByType(t);this.filteredData.stockData=this.filterByStock(e,a,n)}else{const t=this.priceRangeInput,[a,n]=this.addListenerByType(t);this.filteredData.priceData=this.filterByPrice(e,a,n)}}addListenerByType(t){return t.priceInputMin.addEventListener("change",(()=>t.changePriceInputMin())),t.priceInputMax.addEventListener("change",(()=>t.changePriceInputMax())),t.rangeInputMin.addEventListener("input",(()=>t.changeRangeInputMin())),t.rangeInputMax.addEventListener("input",(()=>t.changeRangeInputMax())),[t.priceInputMin.value,t.priceInputMax.value]}filterByPrice(t,e,a){return t.filter((t=>+e<=t.price&&t.price<=+a))}filterByStock(t,e,a){return t.filter((t=>+e<=t.stock&&t.stock<=+a))}checkboxFilter(t,e){if(!c(t))throw new Error;t.closest(".filter__type")&&(this.filteredData.checkCategoryData=this.categoryFilter.checkboxTypeFilter(t,e)),t.closest(".filter__height")&&(this.filteredData.checkHeightData=this.heightFilter.checkboxTypeFilter(t,e)),t.closest(".filter__sale")&&(this.filteredData.checkSaleData=this.saleFilter.checkboxTypeFilter(t,e))}sortInput(t){const e=l(".sort-input").value.toLowerCase().trim();this.filteredData.inputData=t.filter((t=>t.title.toLowerCase().includes(e)||t.type.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)))}sortBy(t,e){if(!c(t))throw new Error;switch(t.dataset.sort){case"rating-up":this.filteredData.sortData=e.sort(((t,e)=>t.rating-e.rating));break;case"rating-down":this.filteredData.sortData=e.sort(((t,e)=>e.rating-t.rating));break;case"price-up":this.filteredData.sortData=e.sort(((t,e)=>t.price-e.price));break;case"price-down":this.filteredData.sortData=e.sort(((t,e)=>e.price-t.price))}}changeLayout(t){if(!c(t))throw new Error;const e=l(".layout__portrait"),a=l(".layout__landscape"),n=l(".products__container");t===e?(e.classList.add("active"),a.classList.remove("active"),n.classList.remove("landscape")):t===a&&(a.classList.add("active"),e.classList.remove("active"),n.classList.add("landscape"))}getData(){const t=this.filteredData.getFinalData();return this.productCount.textContent=t.length+"",t}}(e);l(".filter").addEventListener("input",(t=>{a.checkboxFilter(t.target,e),a.rangeInputFilter(t.target,e),this.productCard.draw(a.getData())})),l(".sort-input").addEventListener("input",(()=>{a.sortInput(e),this.productCard.draw(a.getData())})),l(".sort").addEventListener("click",(t=>{a.sortBy(t.target,e),this.productCard.draw(a.getData())})),l(".layout").addEventListener("click",(t=>{a.changeLayout(t.target)})),l(".button_filter").addEventListener("click",(()=>{console.log("reset")}))}draw(t){const e=this.makePage(t);e&&this.container&&(this.container.innerHTML="",this.container.append(e),this.drawProductCard(s))}},v=class extends h{constructor(t){super(t,"error")}},b=class extends h{constructor(t){super(t,"product-page"),this.cart=t}getPlant(){return this.plantId?s.products.filter((t=>t.id===Number(this.plantId)))[0]:s.products[0]}setDescription(t){const e=this.getPlant();[["Title",`${e.title}`],["Type",`${e.type}`],["Description",`${e.description}`],["Price (with discount)",`$ ${e.price}`],["Height",`${e.height} cm.`],["Rating",`&#9733 ${e.rating}`],["Quantity in stock",`${e.stock} psc.`]].forEach((e=>{const a=document.createElement("li");a.classList.add("product-page__specification-item");const n=document.createElement("span");n.classList.add("product-page__specification-name"),n.innerHTML=e[0];const i=document.createElement("span");i.classList.add("product-page__specification-text"),i.innerHTML=e[1],a.append(n,i),t.append(a)}))}makePopup(){const t=document.createElement("div");t.classList.add("product-page__popup"),t.addEventListener("click",(function(e){e.target instanceof HTMLElement&&(e.target.classList.contains("product-page__popup-img")||(t.classList.remove("product-page__popup_active"),document.body.classList.remove("body_hold")))}));const e=document.createElement("img");return e.classList.add("product-page__popup-img"),t.append(e),document.body.append(t),{popupContainer:e,popup:t}}setPictures(t){const e=this.getPlant(),a=this.makePopup(),n=t.querySelector(".product-page__photo-block");n instanceof HTMLElement&&(n.style.backgroundImage=`url('assets/img/${e.thumbnail}')`,n.addEventListener("click",(function(t){const e=t.target;if(e instanceof HTMLElement&&e.classList.contains("product-page__photo-block")){const t=e.style.backgroundImage.slice(5,-2);a.popupContainer.src=t,a.popup.classList.add("product-page__popup_active"),document.body.classList.add("body_hold")}})),e.images.forEach(((t,e)=>{const a=document.createElement("img");a.src=`assets/img/${t}`,a.classList.add("product-page__photo-mini"),a.addEventListener("click",(function(t){const e=t.target;if(e instanceof HTMLImageElement){n.style.backgroundImage=`url('${e.src}')`;const t=document.querySelector(".product-page__photo-mini_active");null==t||t.classList.remove("product-page__photo-mini_active"),e.classList.add("product-page__photo-mini_active")}})),0===e&&a.classList.add("product-page__photo-mini_active"),n&&n.append(a)})))}fillPage(t,e){if(this.plantId=e,t instanceof DocumentFragment){const e=this.getPlant();if(e){const a=t.querySelector("#product-title");a&&(a.innerHTML=e.title);const n=t.querySelector("#navigation-name");n&&(n.innerHTML=e.title);const i=t.querySelector(".product-page__info-text");i&&(i.innerHTML=e.description);const r=t.querySelector(".product-page__stoke-amount");if(e.stock>0)r&&(r.innerHTML=`(${e.stock} psc.)`);else{r&&(r.innerHTML="not in stock");const e=t.querySelector(".product-page__stoke-text");e instanceof HTMLElement&&(e.style.display="none")}const s=t.querySelector(".product-page__new-price");if(s&&(s.innerHTML=e.price.toString()),e.discountPercentage>0){const t=Math.ceil(e.price/((100-e.discountPercentage)/100)),a=document.createElement("span");a.textContent=t.toString(),a.classList.add("product-page__old-price","usd-symbol"),s&&s.after(a),s instanceof HTMLElement&&s.classList.add("product-page__new-price_sale")}const o=t.querySelector(".product-page__specification-list");o&&this.setDescription(o),this.setPictures(t);const c=t.querySelector(".product-page__add-to-cart-btn"),l=t.querySelector(".product-page__buy-now-btn");c instanceof HTMLElement&&p(c,this.cart,this.getPlant()),l instanceof HTMLElement&&function(t,e,a){const n=a.id.toString();a.stock>0?(t.classList.add("button-light"),t.addEventListener("click",(function(){!(n in e.basket)&&e.add(n),e.updateHeader(),L.goTo("/cart"),d(e)}))):(t.classList.add("button-unable"),t.innerHTML="Not available")}(l,this.cart,this.getPlant())}}return t}};class _{constructor(t){_.catalogPage=new y(t),_.cartPage=new g(t),_.plantPage=new b(t),_.errorPage=new v(t)}static render(t){switch(console.log("render start",t),t){case"/catalog":_.catalogPage.draw();break;case"/cart":_.cartPage.draw();break;case"/":this.goTo("/catalog");break;default:"/"===(e=t)[0]&&(e=e.slice(1)),Number(e)>0&&Number(e)<=s.total?_.plantPage.draw(t.slice(1)):_.errorPage.draw()}var e;_.changeLinks()}static goTo(t){window.history.pushState({pageId:t},t,t),_.render(t)}static changeLinks(){document.querySelectorAll('[href^="/"]').forEach((t=>{t.classList.contains("link-changed")||(t.addEventListener("click",(e=>{e.preventDefault(),t instanceof HTMLAnchorElement&&_.goTo(new URL(t.href).pathname)})),t.classList.add("link-changed"))}))}static startRouter(){window.addEventListener("popstate",(()=>{_.render(new URL(window.location.href).pathname)}));const t=new URL(window.location.href).pathname;_.render(t),_.getQueryParams()}static getQueryParams(){const t=new URLSearchParams({searchInput:"",category:"succulent",height:"35",sale:"no",priceMin:"4",priceMax:"60",stockMin:"7",stockMax:"30"}),e=window.location.href,a=new URL("catalog",e);a.search=t.toString(),console.log(a.toString())}}var L=_;class w{constructor(){this.cart=this.setCart(),w.router=new L(this.cart)}setCart(){const t=new class{constructor(){this.basket={},this.activePromoCodes=[]}getProductAmount(){let t=0;for(const e in this.basket)t+=this.basket[e];return t}getProductSum(){let t=0;for(const e in this.basket){const a=s.products.filter((t=>t.id.toString()===e))[0];t+=this.basket[e]*a.price}return t}getProductOldSum(){let t=0;for(const e in this.basket){const a=s.products.filter((t=>t.id.toString()===e))[0];t+=this.basket[e]*(a.price/(1-a.discountPercentage/100))}return Math.ceil(t)}showProductAmount(t){t&&(t.innerHTML=this.getProductAmount().toString())}showProductSum(t){t&&(t.innerHTML=this.getProductSum().toString())}showProductOldSum(t){t&&(t.innerHTML=this.getProductOldSum().toString())}saveCart(){const t={basket:this.basket,activePromoCodes:this.activePromoCodes};localStorage.setItem("cart",JSON.stringify(t))}updateHeader(){const t=document.getElementById("header-amount"),e=document.getElementById("header-sum");this.showProductAmount(t),this.showProductSum(e)}add(t){(s.products.filter((e=>e.id===Number(t)))[0].stock>this.basket[t]||!this.basket[t])&&(this.basket[t]?this.basket[t]+=1:this.basket[t]=1),this.saveCart()}delete(t){t in this.basket&&(1===this.basket[t]?delete this.basket[t]:this.basket[t]-=1),this.saveCart()}deletePromo(t){this.activePromoCodes=this.activePromoCodes.filter((e=>e!==t.id)),this.saveCart()}addPromo(t){const e=t.value.toUpperCase();e in o&&!this.activePromoCodes.includes(e)&&this.activePromoCodes.push(e),this.saveCart()}cleanCart(){Object.keys(this.basket).forEach((t=>{delete this.basket[t]})),this.updateHeader(),this.saveCart()}},e=localStorage.getItem("cart");if(e){const a=JSON.parse(e);a.basket&&(t.basket=a.basket),a.activePromoCodes&&(t.activePromoCodes=a.activePromoCodes)}return console.log(t),t}start(){L.startRouter(),this.cart.updateHeader()}}(new w).start()}()}();